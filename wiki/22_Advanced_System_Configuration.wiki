#summary Extra and advanced system configuration options (SCST settings, HA, etc.).

=== Kernel Modules ===
The ESOS kernels (production / debug) are built with most drivers built-in. Generally the HBA, HCA, etc. drivers are left as modules in case the user would like to tweak any parameters via module options. The SCST core, device handlers, and target drivers are also modules.

If you do find you would like to customize any of the module parameters, first exit to the shell (Interface -> Exit to Shell) and then you can create the file `/etc/modprobe.conf` (which will be sync'd to USB if it exists). Below is an example to see the format of the file, we are not recommending you use these settings, its just a sample.
{{{
options scst scst_threads=20
options ib_srpt srpt_sq_size=32
}}}

You can see the valid parameters for a module using the `modinfo` command. See the [http://scst.sourceforge.net SCST] documentation for possible information on tweaking any module parameters.

Synchronize your configuration:
{{{
conf_sync.sh
}}}

<br>

=== Extra Configuration ===
If you find that you need to run any extra commands on ESOS start-up, there are two files you can create/edit in /etc:
  * /etc/pre-scst_xtra_conf
  * /etc/post-scst_xtra_conf
These files can be treated as shell scripts; if either exists, they will be executed during start-up with `sh`.

The first file (/etc/pre-scst_xtra_conf) will be executed (if it exists) _before_ any part of SCST is loaded. An example of something you may want to run before loading SCST is adjust the read-ahead value for a back-storage block device (eg, `blockdev --setra 2048 /dev/sdb`).

The second file (/etc/post-scst_xtra_conf) will be executed (if it exists) _after_ SCST is fully loaded and configured. If you want to adjust the SMP IRQ affinity for the system, this would probably be a good place for it.

Synchronize your configuration:
{{{
conf_sync.sh
}}}

<br>

=== High Availability (HA) / Clustering via the Pacemaker + Corosync Stack ===
TODO

<br>

=== InfiniBand Subnet Manager ===
The OpenSM IB subnet manager software is also included with ESOS. It is disabled by default, but can be enabled by adding the binary (`/usr/sbin/opensm`) and associated configuration options to the pre-SCST configuration file: /etc/pre-scst_xtra_conf

The following OpenSM configuration file locations should be used with ESOS (they'll be synchronized to the USB flash drive):
  * /etc/opensm/opensm.conf
  * /etc/opensm/ib-node-name-map
  * /etc/opensm/partitions.conf
  * /etc/opensm/qos-policy.conf
  * /etc/opensm/prefix-routes.conf
  * /etc/opensm/per-module-logging.conf
  * /etc/opensm/torus-2QoS.conf

For additional OpenSM IB subnet manager help/information, please see the related OFED documentation.

<br>

=== Enabling/Disabling System Services ===
Some of the ESOS system services can be enabled/disabled; typically this is needed if your specific configuration or setup has conflicting services. A common example is using DRBD on a stand-alone ESOS server, versus using DRBD in a ESOS cluster. In the latter scenario, you would typically want the cluster stack to manage the DRBD resources, so you would disable the `rc.drbd` service.

Edit the "/etc/rc.conf" file and use 'YES' to enable a service, and 'NO' to disable a service. You can then use the following CLI command syntax to start/stop a service without rebooting:
{{{
/etc/rc.d/rc.service_name [start | stop]
}}}

<br>

=== What's Next ===
From here, you can now SSH into your ESOS storage server, configure your back-storage and setup your targets. Continue with the [31_Basic_Back_End_Storage_Setup] document.